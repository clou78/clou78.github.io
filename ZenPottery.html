<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zen Pottery - 禅陶芸</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Quicksand:wght@300;500&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Quicksand', sans-serif;
            background-color: #e0e5d1;
            user-select: none;
        }
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
        .interactive {
            pointer-events: auto;
        }
        canvas {
            display: block;
        }
        .panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
        }
        .title-text {
            font-family: 'Playfair Display', serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #painting-canvas {
            display: none;
        }
        .settings-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .settings-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
    </style>
</head>
<body>

<div id="settings-modal" class="settings-overlay">
    <div class="panel p-8 w-80 interactive flex flex-col gap-6">
        <div>
            <h2 class="title-text text-2xl font-bold mb-1">Settings</h2>
            <p class="text-[10px] uppercase tracking-widest opacity-50">Configuration</p>
        </div>
        
        <div class="flex flex-col gap-3">
            <p class="text-xs font-bold uppercase tracking-wider text-gray-500">Graphics Quality</p>
            <div class="flex gap-2">
                <button id="gfx-low" onclick="setGraphics('low')" class="graphics-btn flex-1 py-2 text-xs border border-gray-200 rounded-lg hover:bg-white transition-colors">Low</button>
                <button id="gfx-med" onclick="setGraphics('med')" class="graphics-btn flex-1 py-2 text-xs border border-gray-200 rounded-lg bg-white font-bold">Med</button>
                <button id="gfx-high" onclick="setGraphics('high')" class="graphics-btn flex-1 py-2 text-xs border border-gray-200 rounded-lg hover:bg-white transition-colors">High</button>
            </div>
        </div>

        <div class="border-t border-gray-200 pt-4 flex flex-col gap-2">
            <p class="text-[10px] uppercase tracking-widest text-gray-400">Creators</p>
            <p class="text-sm font-bold text-gray-700">HP+ STUDIO</p>
            <a href="https://t.me/HPLUS_AI" target="_blank" class="text-xs text-blue-600 hover:underline">Telegram: HPLUS_AI</a>
        </div>

        <button id="close-settings" class="mt-2 py-3 bg-[#2d3a2d] text-white rounded-xl text-sm font-bold tracking-widest uppercase hover:bg-black transition-colors">Close</button>
    </div>
</div>

<div id="ui-layer" class="flex flex-col justify-between p-8">
    <!-- Header -->
    <div class="flex justify-between items-start">
        <div class="text-[#2d3a2d]">
            <h1 class="title-text text-4xl font-bold tracking-tight">Zen Pottery</h1>
            <p class="text-xs opacity-60 tracking-[0.2em] uppercase">Meditation through clay</p>
        </div>
        <div class="interactive flex items-center gap-3">
            <button id="settings-btn" class="panel w-10 h-10 flex items-center justify-center hover:bg-white transition-all cursor-pointer" title="Settings">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
            <button id="reset-btn" class="panel w-10 h-10 flex items-center justify-center hover:bg-white transition-all cursor-pointer" title="Reset">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
            </button>
            <button id="photo-btn" class="panel w-10 h-10 flex items-center justify-center hover:bg-white transition-all cursor-pointer" title="Capture">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>
            </button>
        </div>
    </div>

    <!-- Main Workflow Navigation (Bottom Right) -->
    <div class="fixed bottom-8 right-8 flex flex-col items-end gap-4 pointer-events-none">
        <div id="decorating-ui" class="hidden interactive flex flex-col gap-3 mb-2 animate-fade-in">
             <div class="panel p-3 flex flex-col gap-2">
                <div class="flex gap-2">
                    <button class="color-pick w-7 h-7 rounded-full border-2 border-white shadow-sm transition-transform hover:scale-110" style="background: #ffffff;"></button>
                    <button class="color-pick w-7 h-7 rounded-full border-2 border-white shadow-sm transition-transform hover:scale-110" style="background: #2a2a2a;"></button>
                    <button class="color-pick w-7 h-7 rounded-full border-2 border-white shadow-sm transition-transform hover:scale-110" style="background: #3c5a5e;"></button>
                    <button class="color-pick w-7 h-7 rounded-full border-2 border-white shadow-sm transition-transform hover:scale-110" style="background: #8b4513;"></button>
                    <button class="color-pick w-7 h-7 rounded-full border-2 border-white shadow-sm transition-transform hover:scale-110" style="background: #d4af37;"></button>
                </div>
                <div class="flex gap-2">
                    <button id="stamp-lotus" class="flex-1 py-1 text-[10px] uppercase tracking-wider font-bold text-gray-600 bg-white/50 rounded hover:bg-white transition-colors">Lotus</button>
                    <button id="stamp-wave" class="flex-1 py-1 text-[10px] uppercase tracking-wider font-bold text-gray-600 bg-white/50 rounded hover:bg-white transition-colors">Wave</button>
                </div>
             </div>
        </div>

        <button id="next-step-btn" class="panel interactive px-6 py-4 flex items-center gap-3 hover:bg-white group transition-all">
            <span id="next-step-text" class="text-sm font-bold uppercase tracking-widest text-[#2d3a2d]">Firing</span>
            <svg class="group-hover:translate-x-1 transition-transform" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2d3a2d" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
        </button>
    </div>

    <!-- Centered Notifications/Status -->
    <div id="status-overlay" class="absolute inset-0 flex items-center justify-center pointer-events-none">
        <div id="firing-ui" class="hidden flex-col items-center bg-white/20 backdrop-blur-md p-8 rounded-full border border-white/30 animate-pulse">
            <div id="fire-progress" class="w-48 h-1 bg-white/30 rounded-full overflow-hidden mb-4">
                <div id="fire-bar" class="w-0 h-full bg-orange-400 transition-all duration-100"></div>
            </div>
            <p id="fire-status" class="title-text text-xl text-white drop-shadow-md">Forging in Flame</p>
        </div>
        
        <div id="shaping-info" class="text-center text-[#2d3a2d]/60">
            <p class="title-text italic text-lg">Gently guide the clay...</p>
        </div>
    </div>
</div>

<canvas id="painting-canvas" width="1024" height="1024"></canvas>

<script>
    // --- Constants and State ---
    let mode = 'shaping'; 
    let isTouching = false;
    let clayPoints = [];
    const numPoints = 40; // Increased for smoothness
    const vaseHeight = 10;
    const baseRadius = 2.5;
    let graphicsQuality = 'med';
    let segments = 64;

    let paintInterval = null;
    let currentPaintY = 0;
    
    // --- Audio setup ---
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    let audioCtx, wheelGain;

    function initAudio() {
        if (audioCtx) return;
        audioCtx = new AudioCtx();
        wheelGain = audioCtx.createGain();
        wheelGain.gain.value = 0;
        wheelGain.connect(audioCtx.destination);
        const osc = audioCtx.createOscillator();
        osc.type = 'sine';
        osc.frequency.setValueAtTime(50, audioCtx.currentTime);
        osc.connect(wheelGain);
        osc.start();
    }

    function setWheelSound(vol) {
        if (!wheelGain) return;
        wheelGain.gain.setTargetAtTime(vol, audioCtx.currentTime, 0.1);
    }

    // --- Three.js Setup ---
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0xb5c4a3);
    scene.fog = new THREE.Fog(0xb5c4a3, 15, 70);

    const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(20, 15, 20);
    camera.lookAt(0, 5, 0);

    const renderer = new THREE.WebGLRenderer({ antialias: true, preserveDrawingBuffer: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    document.body.appendChild(renderer.domElement);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.target.set(0, 5, 0);
    controls.maxPolarAngle = Math.PI / 1.8;

    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(ambientLight);

    const sunLight = new THREE.DirectionalLight(0xfffaf0, 1.0);
    sunLight.position.set(15, 25, 10);
    sunLight.castShadow = true;
    sunLight.shadow.mapSize.width = 1024;
    sunLight.shadow.mapSize.height = 1024;
    scene.add(sunLight);

    // Rim light for depth
    const rimLight = new THREE.PointLight(0xffffff, 0.4);
    rimLight.position.set(-15, 10, -15);
    scene.add(rimLight);

    const tableGroup = new THREE.Group();
    const wheelBase = new THREE.Mesh(
        new THREE.CylinderGeometry(5.5, 6, 4, 16), 
        new THREE.MeshStandardMaterial({ color: 0x808080, roughness: 0.9 })
    );
    wheelBase.position.y = -1;
    wheelBase.receiveShadow = true;
    tableGroup.add(wheelBase);

    const wheelTop = new THREE.Mesh(
        new THREE.CylinderGeometry(4.8, 4.8, 0.3, 48), 
        new THREE.MeshStandardMaterial({ color: 0x3d352d, roughness: 0.7 })
    );
    wheelTop.position.y = 1.1;
    wheelTop.receiveShadow = true;
    tableGroup.add(wheelTop);
    scene.add(tableGroup);

    function addNature() {
        const grass = new THREE.Mesh(
            new THREE.CircleGeometry(60, 32), 
            new THREE.MeshStandardMaterial({ color: 0x4a5a3a })
        );
        grass.rotation.x = -Math.PI / 2;
        grass.receiveShadow = true;
        scene.add(grass);

        for(let i=0; i<50; i++) {
            const leaf = new THREE.Mesh(
                new THREE.SphereGeometry(Math.random()*2 + 1, 8, 8),
                new THREE.MeshStandardMaterial({ color: new THREE.Color().setHSL(0.25 + Math.random()*0.1, 0.3, 0.2), transparent: true, opacity: 0.7 })
            );
            const angle = Math.random() * Math.PI * 2;
            const dist = 30 + Math.random() * 30;
            leaf.position.set(Math.cos(angle)*dist, 5 + Math.random()*20, Math.sin(angle)*dist);
            scene.add(leaf);
        }
    }
    addNature();

    let vaseMesh;
    const pCanvas = document.getElementById('painting-canvas');
    const pCtx = pCanvas.getContext('2d');
    pCtx.fillStyle = '#b09e89';
    pCtx.fillRect(0, 0, 1024, 1024);
    const vaseTexture = new THREE.CanvasTexture(pCanvas);

    const clayMaterial = new THREE.MeshStandardMaterial({ 
        map: vaseTexture, roughness: 0.8, metalness: 0.1, side: THREE.DoubleSide
    });

    function initClay() {
        clayPoints = [];
        // Base
        clayPoints.push(new THREE.Vector2(0.01, 0));
        clayPoints.push(new THREE.Vector2(baseRadius, 0));
        for (let i = 1; i < numPoints - 2; i++) {
            clayPoints.push(new THREE.Vector2(baseRadius, (i / (numPoints - 3)) * vaseHeight));
        }
        // Top Rim/Neck Structure
        clayPoints.push(new THREE.Vector2(baseRadius - 0.2, vaseHeight));
        clayPoints.push(new THREE.Vector2(0.01, vaseHeight));
        updateVaseGeometry();
    }

    function updateVaseGeometry() {
        if (vaseMesh) {
            scene.remove(vaseMesh);
            vaseMesh.geometry.dispose();
        }
        const geometry = new THREE.LatheGeometry(clayPoints, segments);
        vaseMesh = new THREE.Mesh(geometry, clayMaterial);
        vaseMesh.position.y = 1.25;
        vaseMesh.castShadow = true;
        vaseMesh.receiveShadow = true;
        scene.add(vaseMesh);
    }

    initClay();

    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();
    let lastMouseX = 0;

    function handleInputStart(x, y) {
        initAudio();
        isTouching = true;
        lastMouseX = x;
        if (mode === 'shaping') {
            controls.enabled = false;
            setWheelSound(0.15);
        } else if (mode === 'decorating') {
            controls.enabled = false;
            startIncrementalPaint(x, y);
        }
    }

    function handleInputMove(x, y) {
        if (!isTouching) return;
        if (mode === 'shaping') {
            const dx = x - lastMouseX;
            mouse.x = (x / window.innerWidth) * 2 - 1;
            mouse.y = -(y / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObject(vaseMesh);
            if (intersects.length > 0) {
                const localY = intersects[0].point.y - 1.25;
                const pointIndex = Math.round((localY / vaseHeight) * (numPoints - 4)) + 2;
                if (pointIndex >= 2 && pointIndex < numPoints - 1) {
                    const change = dx * 0.008;
                    // Gaussian-like smoothing influence
                    const spread = 8;
                    for(let i = 2; i < numPoints - 1; i++) {
                        const dist = Math.abs(i - pointIndex);
                        if (dist < spread) {
                            const weight = Math.pow(1 - dist/spread, 3);
                            clayPoints[i].x = Math.max(0.3, Math.min(4.5, clayPoints[i].x + change * weight));
                        }
                    }
                    // Keep neck slightly responsive but maintain rim
                    clayPoints[numPoints-1].x = clayPoints[numPoints-2].x - 0.15;
                    updateVaseGeometry();
                }
            }
        } else if (mode === 'decorating') {
            updatePaintPosition(x, y);
        }
        lastMouseX = x;
    }

    function handleInputEnd() {
        isTouching = false;
        controls.enabled = true;
        setWheelSound(0);
        stopIncrementalPaint();
    }

    let brushColor = '#ffffff';
    let brushSize = 25;

    function startIncrementalPaint(x, y) {
        updatePaintPosition(x, y);
        if (paintInterval) clearInterval(paintInterval);
        paintInterval = setInterval(() => {
            if (currentPaintY !== null) {
                pCtx.globalAlpha = 0.2; // 20% opacity build up
                pCtx.fillStyle = brushColor;
                pCtx.fillRect(0, currentPaintY - brushSize/2, 1024, brushSize);
                pCtx.globalAlpha = 1.0;
                vaseTexture.needsUpdate = true;
            }
        }, 100); // Builds up over 0.5s approx
    }

    function updatePaintPosition(x, y) {
        mouse.x = (x / window.innerWidth) * 2 - 1;
        mouse.y = -(y / window.innerHeight) * 2 + 1;
        raycaster.setFromCamera(mouse, camera);
        const intersects = raycaster.intersectObject(vaseMesh);
        if (intersects.length > 0) {
            currentPaintY = (1 - intersects[0].uv.y) * 1024;
        } else {
            currentPaintY = null;
        }
    }

    function stopIncrementalPaint() {
        if (paintInterval) {
            clearInterval(paintInterval);
            paintInterval = null;
        }
    }

    function setGraphics(q) {
        graphicsQuality = q;
        document.querySelectorAll('.graphics-btn').forEach(b => b.classList.remove('bg-white', 'font-bold'));
        document.getElementById('gfx-' + q).classList.add('bg-white', 'font-bold');

        if (q === 'low') {
            segments = 32;
            sunLight.shadow.mapSize.set(256, 256);
            renderer.setPixelRatio(1);
        } else if (q === 'med') {
            segments = 64;
            sunLight.shadow.mapSize.set(1024, 1024);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        } else {
            segments = 128;
            sunLight.shadow.mapSize.set(2048, 2048);
            renderer.setPixelRatio(window.devicePixelRatio);
        }
        sunLight.shadow.map?.dispose();
        sunLight.shadow.map = null;
        updateVaseGeometry();
    }

    // --- Events ---
    window.addEventListener('mousedown', (e) => handleInputStart(e.clientX, e.clientY));
    window.addEventListener('mousemove', (e) => handleInputMove(e.clientX, e.clientY));
    window.addEventListener('mouseup', handleInputEnd);

    window.addEventListener('touchstart', (e) => {
        const t = e.touches[0];
        handleInputStart(t.clientX, t.clientY);
    }, { passive: false });
    window.addEventListener('touchmove', (e) => {
        const t = e.touches[0];
        handleInputMove(t.clientX, t.clientY);
        e.preventDefault();
    }, { passive: false });
    window.addEventListener('touchend', handleInputEnd);

    // Settings logic
    const settingsModal = document.getElementById('settings-modal');
    document.getElementById('settings-btn').addEventListener('click', () => settingsModal.classList.add('active'));
    document.getElementById('close-settings').addEventListener('click', () => settingsModal.classList.remove('active'));

    document.getElementById('next-step-btn').addEventListener('click', () => {
        if (mode === 'shaping') setMode('firing');
    });

    document.querySelectorAll('.color-pick').forEach(btn => {
        btn.addEventListener('click', () => {
            brushColor = btn.style.background;
            brushSize = 25;
        });
    });

    document.getElementById('stamp-lotus').addEventListener('click', () => { brushSize = 50; brushColor = '#d4af37'; });
    document.getElementById('stamp-wave').addEventListener('click', () => { brushSize = 40; brushColor = '#3c5a5e'; });

    document.getElementById('reset-btn').addEventListener('click', () => {
        initClay();
        pCtx.fillStyle = '#b09e89';
        pCtx.fillRect(0, 0, 1024, 1024);
        vaseTexture.needsUpdate = true;
        clayMaterial.roughness = 0.8;
        clayMaterial.metalness = 0.1;
        setMode('shaping');
    });

    document.getElementById('photo-btn').addEventListener('click', () => {
        const flash = document.createElement('div');
        flash.className = 'fixed inset-0 bg-white z-[100] pointer-events-none opacity-0 transition-opacity duration-300';
        document.body.appendChild(flash);
        setTimeout(() => flash.style.opacity = '1', 10);
        setTimeout(() => { flash.style.opacity = '0'; setTimeout(() => document.body.removeChild(flash), 300); }, 100);

        const dataURL = renderer.domElement.toDataURL('image/png');
        const link = document.createElement('a');
        link.download = `zen-vase-${Date.now()}.png`;
        link.href = dataURL;
        link.click();
    });

    function setMode(newMode) {
        if (mode === 'firing' && newMode !== 'decorating') return; 
        
        mode = newMode;
        
        const info = document.getElementById('shaping-info');
        const fui = document.getElementById('firing-ui');
        const dui = document.getElementById('decorating-ui');
        const nextBtn = document.getElementById('next-step-btn');
        const nextText = document.getElementById('next-step-text');

        info.classList.add('hidden');
        fui.classList.add('hidden');
        dui.classList.add('hidden');
        nextBtn.classList.remove('hidden');

        if (mode === 'shaping') {
            info.classList.remove('hidden');
            nextText.innerText = "To Kiln";
        }
        if (mode === 'firing') {
            fui.classList.remove('hidden');
            nextBtn.classList.add('hidden');
            startFiring();
        }
        if (mode === 'decorating') {
            dui.classList.remove('hidden');
            nextBtn.classList.add('hidden'); // No next step for now
        }
    }

    function startFiring() {
        let progress = 0;
        const bar = document.getElementById('fire-bar');
        const status = document.getElementById('fire-status');
        status.innerText = "Forging in Flame...";
        
        const interval = setInterval(() => {
            progress += 1.6; // ~8 seconds total
            bar.style.width = Math.min(progress, 100) + '%';
            
            const heat = Math.min(progress / 100, 1.0);
            clayMaterial.emissive.setRGB(heat * 0.7, heat * 0.2, 0);
            
            if (progress >= 100) {
                clearInterval(interval);
                status.innerText = "Ceramic Perfected";
                
                clayMaterial.emissive.setRGB(0, 0, 0);
                clayMaterial.roughness = 0.12;
                clayMaterial.metalness = 0.25;
                
                setTimeout(() => setMode('decorating'), 1500);
            }
        }, 128);
    }

    // --- Animation Loop ---
    function animate() {
        requestAnimationFrame(animate);
        
        const rotationSpeed = (mode === 'firing') ? 0.005 : 0.02;
        tableGroup.rotation.y += rotationSpeed;
        if (vaseMesh) vaseMesh.rotation.y += rotationSpeed;

        controls.update();
        renderer.render(scene, camera);
    }

    animate();

    // Handle Resize
    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });

</script>
</body>
</html>